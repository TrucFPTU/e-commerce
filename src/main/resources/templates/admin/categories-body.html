<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<th:block th:fragment="body">
    <!-- Search Section -->
    <div class="search-section">
        <p>G√µ l√† ra k·∫øt qu·∫£ ngay. T√¨m ki·∫øm theo: t√™n th·ªÉ lo·∫°i.</p>
        <div class="search-controls">
            <input type="text" class="search-input" id="searchInput" placeholder="Nh·∫≠p t·ª´ kh√≥a ƒë·ªÉ t√¨m th·ªÉ lo·∫°i...">
            <button class="btn btn-secondary" onclick="document.getElementById('searchInput').value=''; AdminCategory.initSearch(); AdminCategory.updateCount();">X√≥a l·ªçc</button>
            <button class="btn btn-success" onclick="AdminCategory.openAddModal()">+ Th√™m th·ªÉ lo·∫°i m·ªõi</button>
        </div>
    </div>

    <!-- Categories Table -->
    <div class="categories-section">
        <div class="section-header">
            <h2>Danh s√°ch th·ªÉ lo·∫°i</h2>
            <span class="total-count">T·ªïng: <strong id="categoryCount" th:text="${#lists.size(categories)}">0</strong> th·ªÉ lo·∫°i</span>
        </div>

        <div class="table-wrapper">
            <table id="categoriesTable">
                <thead>
                    <tr>
                        <th style="width: 80px">M√£</th>
                        <th>T√™n th·ªÉ lo·∫°i</th>
                        <th style="width: 200px; text-align: center">Thao t√°c</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="category : ${categories}" th:data-search="${category.categoryId + ' ' + category.name}">
                        <td th:text="${category.categoryId}">1</td>
                        <td>
                            <strong th:text="${category.name}">Ti·ªÉu thuy·∫øt</strong>
                        </td>
                        <td style="text-align: center">
                            <div class="action-buttons" style="justify-content: center">
                                <button class="btn btn-primary btn-sm" 
                                        th:data-id="${category.categoryId}"
                                        onclick="AdminCategory.openEditModal(this.dataset.id)"
                                        title="Ch·ªânh s·ª≠a">
                                    ‚úèÔ∏è S·ª≠a
                                </button>
                                <button class="btn btn-danger btn-sm" 
                                        th:data-id="${category.categoryId}"
                                        th:data-name="${category.name}"
                                        onclick="AdminCategory.deleteCategory(this.dataset.id, this.dataset.name)"
                                        title="X√≥a">
                                    üóëÔ∏è X√≥a
                                </button>
                            </div>
                            
                            <!-- Hidden delete form -->
                            <form th:id="'deleteForm_' + ${category.categoryId}" 
                                  th:action="@{/admin/categories/delete/{id}(id=${category.categoryId})}" 
                                  method="post" 
                                  style="display:none">
                            </form>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Add/Edit Modal -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Th√™m Th·ªÉ lo·∫°i M·ªõi</h2>
                <button type="button" class="close-btn" onclick="AdminCategory.closeModal()">&times;</button>
            </div>

            <form id="categoryForm" th:action="@{/admin/categories/save}" method="post">
                <input type="hidden" id="categoryId" name="categoryId">

                <div class="form-group">
                    <label for="name">T√™n th·ªÉ lo·∫°i <span style="color:red">*</span></label>
                    <input type="text" 
                           id="name" 
                           name="name" 
                           required
                           placeholder="Nh·∫≠p t√™n th·ªÉ lo·∫°i">
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="AdminCategory.closeModal()">
                        H·ªßy
                    </button>
                    <button type="submit" class="btn btn-primary">
                        üíæ L∆∞u
                    </button>
                </div>
            </form>
        </div>
    </div>
</th:block>

</html>
