<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<th:block th:fragment="body">
    <!-- Search Section -->
    <div class="search-section">
        <p>G√µ l√† ra k·∫øt qu·∫£ ngay. T√¨m ki·∫øm theo: t√™n, email kh√°ch h√†ng.</p>
        <div class="search-controls">
            <input type="text" class="search-input" id="searchInput" placeholder="Nh·∫≠p t·ª´ kh√≥a ƒë·ªÉ t√¨m kh√°ch h√†ng...">
            <button class="btn btn-secondary" onclick="document.getElementById('searchInput').value=''; AdminCustomer.initSearch(); AdminCustomer.updateCount();">X√≥a l·ªçc</button>
            <button class="btn btn-success" onclick="AdminCustomer.openAddModal()">+ Th√™m kh√°ch h√†ng m·ªõi</button>
        </div>
    </div>

    <!-- Customer Table -->
    <div class="customer-section">
        <div class="section-header">
            <h2>Danh s√°ch kh√°ch h√†ng</h2>
            <span class="total-count">T·ªïng: <strong id="customerCount" th:text="${#lists.size(users)}">0</strong> kh√°ch h√†ng</span>
        </div>

        <div class="table-wrapper">
            <table id="customerTable">
                <thead>
                    <tr>
                        <th style="width: 60px">ID</th>
                        <th>Email</th>
                        <th>H·ªç t√™n</th>
                        <th style="width: 160px; text-align: center">Thao t√°c</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="u : ${users}" th:data-search="${u.userId + ' ' + u.email + ' ' + u.fullName}">
                        <td th:text="${u.userId}">1</td>
                        <td th:text="${u.email}">customer@example.com</td>
                        <td th:text="${u.fullName}">Nguy·ªÖn VƒÉn A</td>
                        <td style="text-align: center">
                            <div class="action-buttons" style="justify-content: center">
                                <button class="btn btn-primary btn-sm" 
                                        th:data-id="${u.userId}"
                                        onclick="AdminCustomer.openEditModal(this.dataset.id)"
                                        title="Ch·ªânh s·ª≠a">
                                    ‚úèÔ∏è S·ª≠a
                                </button>
                                <button class="btn btn-danger btn-sm" 
                                        th:data-id="${u.userId}"
                                        th:data-name="${u.fullName}"
                                        onclick="AdminCustomer.deleteUser(this.dataset.id, this.dataset.name)"
                                        title="X√≥a">
                                    üóëÔ∏è X√≥a
                                </button>
                            </div>
                            
                            <!-- Hidden delete form -->
                            <form th:id="'deleteForm_' + ${u.userId}" 
                                  th:action="@{/admin/customers/delete/{id}(id=${u.userId})}" 
                                  method="post" 
                                  style="display:none">
                            </form>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Add/Edit Modal -->
    <div id="customerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Th√™m Kh√°ch h√†ng M·ªõi</h2>
                <button type="button" class="close-btn" onclick="AdminCustomer.closeModal()">&times;</button>
            </div>

            <form id="customerForm" th:action="@{/admin/customers/save}" method="post">
                <input type="hidden" id="userId" name="userId">

                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Email <span style="color:red">*</span></label>
                        <input type="email" 
                               id="email" 
                               name="email" 
                               required
                               placeholder="Nh·∫≠p email">
                    </div>

                    <div class="form-group">
                        <label for="fullName">H·ªç t√™n <span style="color:red">*</span></label>
                        <input type="text" 
                               id="fullName" 
                               name="fullName" 
                               required
                               placeholder="Nh·∫≠p h·ªç t√™n">
                    </div>
                </div>

                <div class="form-group" id="passwordGroup">
                    <label for="password">M·∫≠t kh·∫©u <span style="color:red">*</span></label>
                    <input type="password" 
                           id="password" 
                           name="password"
                           placeholder="Nh·∫≠p m·∫≠t kh·∫©u"
                           minlength="6">
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="AdminCustomer.closeModal()">
                        H·ªßy
                    </button>
                    <button type="submit" class="btn btn-primary">
                        üíæ L∆∞u
                    </button>
                </div>
            </form>
        </div>
    </div>
</th:block>

</html>
