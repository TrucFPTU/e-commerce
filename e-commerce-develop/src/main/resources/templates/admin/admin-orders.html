<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin - Orders</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 30px; }
        h2 { margin-bottom: 10px; }
        form { margin-bottom: 15px; }
        input, select, button { padding: 8px; margin: 4px 0; }
        table { border-collapse: collapse; width: 100%; margin-top: 10px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: top; }
        th { background: #f5f5f5; }
        .btn { cursor: pointer; width: auto; padding: 6px 10px; display: inline-block; text-decoration: none; }
        .pager { margin-top: 12px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        .muted { color: #666; font-size: 13px; }
        .filters { display: flex; gap: 16px; align-items: flex-end; flex-wrap: wrap; }
        .field { min-width: 220px; }
    </style>
</head>
<body>

<h2>Order Management</h2>

<form th:action="@{/admin/orders}" method="get">
    <div class="filters">
        <div class="field">
            <label>Status</label><br>
            <select name="status">
                <option value="" th:selected="${status == null}">-- All --</option>
                <option th:each="s : ${statuses}"
                        th:value="${s}"
                        th:text="${s}"
                        th:selected="${status == s}">
                </option>
            </select>
        </div>

        <div class="field">
            <label>Page size</label><br>
            <input type="number" name="size" th:value="${size}" min="1" max="100"/>
        </div>

        <button class="btn" type="submit">Filter</button>
    </div>
</form>

<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Order Code</th>
        <th>User</th>
        <th>Total</th>
        <th>Status</th>
        <th>Placed At</th>
        <th>Actions</th>
    </tr>
    </thead>

    <tbody>
    <tr th:if="${#lists.isEmpty(items)}">
        <td colspan="7" class="muted">No orders found.</td>
    </tr>

    <tr th:each="o : ${items}">
        <td th:text="${o.orderId}"></td>
        <td th:text="${o.orderCode}"></td>
        <td>
            <div th:text="${o.userEmail}"></div>
            <div class="muted" th:text="'UserId: ' + ${o.userId}"></div>
        </td>
        <td th:text="${#numbers.formatDecimal(o.total, 0, 'COMMA', 2, 'POINT')}"></td>
        <td th:text="${o.status}"></td>
        <td th:text="${#temporals.format(o.placedAt, 'dd/MM/yyyy HH:mm')}"></td>
        <td>
            <a class="btn" th:href="@{/admin/orders/{id}(id=${o.orderId})}">View</a>
        </td>
    </tr>
    </tbody>
</table>

<div class="pager" th:if="${pageData != null}">
    <div class="muted"
         th:text="'Page ' + (${pageData.number} + 1) + ' / ' + ${pageData.totalPages} + ' â€” Total: ' + ${pageData.totalElements}">
    </div>

    <a class="btn"
       th:if="${pageData.hasPrevious()}"
       th:href="@{/admin/orders(page=${pageData.number - 1}, size=${size}, status=${status != null ? status : ''})}">
        Prev
    </a>

    <a class="btn"
       th:if="${pageData.hasNext()}"
       th:href="@{/admin/orders(page=${pageData.number + 1}, size=${size}, status=${status != null ? status : ''})}">
        Next
    </a>
</div>

</body>
</html>
